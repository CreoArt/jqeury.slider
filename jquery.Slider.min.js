(function(b){b.fn.Slider=function(d){var a=this;d=b.extend({next_bt:".next",prev_bt:".prev",bt_hide:!1,type:!1,hs:!1,duration:1E3,debug:!1,animating:!1},d);a.windowLoaded=!1;a.ul=b("ul:first",this);a.li=b("li",a.ul);a.lif=b("li:first",a.ul);a.idx=0;a.id=b(this).attr("id");a.next_bt=b(d.next_bt,this);a.prev_bt=b(d.prev_bt,this);a.hh=0;a.ulw=0;a.ulfw=0;a.obj=0;a.objr=0;a.liw=0;return this.each(function(){d.bt_hide&&a.prev_bt.hide();a.setup=function(){a.windowLoaded=!0;d.debug&&(console.log("--- Slider setup ---"),
console.log("id: "+a.id),console.log("--- Settings ---"),console.log(d),"gallary"==d.type&&console.log("gallary mode"),console.log("li.length: "+a.li.length),console.log("container & ul setup css"));b(a).css({overflow:"hidden",position:"relative"});a.ul.css({padding:"0","list-style":"none",overflow:"hidden",position:"relative","float":"left",width:"9999px"});a.ulfw=b(a).outerWidth()-a.next_bt.outerWidth()-a.prev_bt.outerWidth();d.debug&&(console.log("container width: "+b(a).outerWidth()),console.log("next bottom width: "+
a.next_bt.outerWidth()),console.log("prev bottom width: "+a.prev_bt.outerWidth()),console.log("ul factory width: "+a.ulfw));d.debug&&console.log("li setup css and max height");a.li.each(function(){a.hh<b(this).outerHeight(!0)&&(a.hh=b(this).outerHeight(!0));b(this).css({padding:"0",margin:"0","list-style":"none",position:"relative","float":"left"});"gallary"==d.type&&(b(this).addClass("gl_"+a.id),b(this).attr("rel","gl_"+a.id+"_"+a.idx),b(this).css("cursor","pointer"),b(this).click(a.gallary),a.idx++)});
a.obj=Math.ceil(a.ulfw/a.li[0].clientWidth);a.objr=a.ulfw/a.li[0].clientWidth;d.debug&&(console.log("Obj: "+a.obj),console.log("Objr: "+a.objr));d.hs&&(d.debug&&console.log("li max height: "+a.hh),b(this).height(a.hh))};a.overlay=function(c,e,d){c=b.extend({width:"auto",height:"auto",close:!0,type:!1,style:"",idx:!1},c);var f="",h="",k="";"gallary"==c.type&&(h='<div id="SliderOverlayNext" style="position:absolute;top:0;bottom:0;right:-20px;background: url(\'images/slider-next.png\') right center no-repeat; width:70px;cursor:pointer;" rel="'+
c.idx+'"></div>',k='<div id="SliderOverlayPrev" style="position:absolute;top:0;bottom:0;left:-20px;background: url(\'images/slider-prev.png\') left center no-repeat; width:70px;cursor:pointer;" rel="'+c.idx+'"></div>');c.close&&(f='<img id="SliderOverlayClose" style="position:absolute;top:-24px;right:-24px;z-index:1002;cursor:pointer;" src="images/slider-close.png">');null==b("#SliderOverlay").html()&&b("body").append('<div id="SliderOverlay" style="position:fixed;top:0;bottom:0;left:0;right:0;background:#000;opacity:0.5;z-index:1000;"></div>');
null==b("#SliderOverlayBox").html()?b("body").append('<div id="SliderOverlayBox" style="display:none;position:fixed;top:50%;left:50%;background:#fff;z-index:1001;width:'+c.width+";height:"+c.height+";"+c.style+'">'+e+""+f+""+h+""+k+"</div>"):(b("#SliderOverlayBox").css({width:c.width+"px",height:c.height+"px"}),b("#SliderOverlayBox").html(e+""+f+""+h+""+k));a.overlay_bind(c,d)};a.overlay_bind=function(c,e){b("#SliderOverlayBox").css({"margin-top":"-"+b("#SliderOverlayBox").outerHeight()/2+"px","margin-left":"-"+
b("#SliderOverlayBox").outerWidth()/2+"px"});c.close&&(b("#SliderOverlay").click(a.overlay_close),b("#SliderOverlayClose").click(a.overlay_close));"gallary"==c.type&&(b("#SliderOverlayNext").click(a.gallary_next),b("#SliderOverlayPrev").click(a.gallary_prev));b("#SliderOverlayBox").is(":hidden")?b("#SliderOverlayBox").show("slow",function(){e&&e()}):e&&e()};a.overlay_close=function(){b("#SliderOverlay").remove();b("#SliderOverlayBox").remove()};a.gallary=function(){var c=b("img",b(this)).attr("rel"),
e=b(this).attr("rel");a.gallary_load(e,c)};a.gallary_array=function(){var c=[];b(".gl_"+a.id).each(function(){c.push(b(this).attr("rel"))});return c};a.gallary_prev=function(){var c=a.gallary_array(),e=b(this).attr("rel"),e=c.indexOf(e);0==e?e=c.length-1:e--;var d=b("img",b("li[rel='"+c[e]+"']")).attr("rel");a.gallary_load(c[e],d)};a.gallary_next=function(){var c=a.gallary_array(),e=b(this).attr("rel"),e=c.indexOf(e);c.length-1<e+1?e=0:e++;var d=b("img",b("li[rel='"+c[e]+"']")).attr("rel");a.gallary_load(c[e],
d)};a.gallary_load=function(b,e){a.overlay({style:"padding:20px;",close:!1},"<center>\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435 \u0438\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430...</center>",function(){var d=new Image;d.onload=function(){a.overlay({width:this.width,height:this.height,type:"gallary",idx:b},'<img src="'+this.src+'" border="0">')};d.src=e+"?"+(new Date).getTime()})};a.next=function(){if(d.animating||!a.windowLoaded)return!1;d.animating=!0;var c=0,
e="$(this)";a.li.each(function(g){var f=0;if("none"!=b(this).css("display")&&g!=a.li.length-1&&0==c){g==a.li.length-a.obj-1&&d.bt_hide&&a.next_bt.hide();if(g==a.li.length||a.obj==a.objr&&g==a.li.length-a.obj)return d.animating=!1;for(f=0;f<a.obj;f++)if(e+=".next()",!eval(e+".html()")&&f<a.obj-1)return d.animating=!1;f=b(this).outerWidth(!0);b(this).animate({left:"-"+f+"px"},d.duration,function(){b(this).hide();d.animating=!1});e="$(this)";for(f=0;f<a.obj;f++)e+=".next()",eval(e+".animate({left: '-'+twh+'px'}, s.duration, function() { $(this).css('left','');});");
c=1;d.bt_hide&&a.prev_bt.show()}"none"!=b(this).css("display")&&g==a.li.length-1&&0==c&&(d.animating=!1)});return!1};a.prev=function(){if(d.animating||!a.windowLoaded)return!1;d.animating=!0;var c=b("li:hidden:last",a.ul);b("li:not(:hidden):first",a.ul);if(0==b("li:hidden",a.ul).length&&!d.bt_hide)return d.animating=!1;c.outerWidth(!0);c.show();c.animate({left:"0px"},1E3,function(){b(this).css("left","");d.animating=!1});for(var c="linhf",e=0;e<a.obj;e++)0!=e&&(c+=".next()"),eval(c+".css('left','-'+twh+'px').animate({left: '0px'}, 1000, function() {$(this).css('left','');});");
0==b("li:hidden",a.ul).length&&d.bt_hide&&a.prev_bt.hide();d.bt_hide&&a.next_bt.show();return!1};a.next_bt.click(a.next);a.prev_bt.click(a.prev);b(window).load(function(){a.setup()})})}})(jQuery);